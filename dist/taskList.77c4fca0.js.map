{"mappings":"C,A,S,C,C,C,C,C,C,C,C,C,E,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,A,Y,O,C,C,E,E,C,C,E,C,E,E,K,E,C,E,E,A,a,O,Q,A,Y,O,O,O,E,O,O,C,I,C,Q,S,E,C,C,C,E,G,C,C,C,E,C,C,G,C,C,C,E,C,C,I,E,A,Y,O,C,C,E,E,C,C,E,C,G,C,G,E,O,E,E,C,G,G,E,O,E,E,C,G,G,G,A,U,O,E,O,E,G,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,O,C,S,C,E,I,E,C,C,E,C,E,C,E,C,O,A,M,E,E,C,E,E,K,C,C,E,I,E,C,C,E,C,I,E,M,C,G,C,C,E,C,E,C,I,C,E,O,C,E,E,E,O,C,I,C,C,O,C,C,E,C,O,C,S,E,C,E,I,E,E,O,C,G,M,A,C,I,E,C,E,E,E,C,C,E,e,C,C,E,E,M,C,S,C,E,I,C,E,C,E,I,C,M,C,E,I,C,O,C,C,C,E,E,O,C,E,E,K,C,E,E,M,C,E,E,Q,C,S,C,C,C,E,C,C,E,C,C,S,C,C,C,E,E,O,C,C,E,C,E,A,E,O,c,C,E,O,C,I,W,O,C,C,E,A,C,G,C,C,E,C,E,I,I,E,E,E,E,M,C,I,E,C,C,E,C,E,C,Q,C,S,C,C,C,C,C,E,I,E,E,kD,E,iB,C,GCiBa,EAAA,MAAA,CAAA,EAAA,WAAA,IAAA,GAjBb,IAAA,EAAA,EAAA,eAKA,EAAA,EAAA,WACA,EAAA,EAAA,c,E,E,c,C,GAEA,IAAM,EAAkB,KACtB,IAAM,EAAM,IAAI,EAAA,WAAW,CAAC,qBAC5B,EAAI,EAAE,CAAC,QAAS,AAAC,IACf,EAAI,cAAc,CAAC,kBACnB,EAAE,cAAc,GAChB,AAAA,CAAA,EAAA,EAAA,MAAK,AAAL,GACF,GACA,EAAI,cAAc,CAAC,SACrB,EACa,EAAW,KACtB,IACA,IAAM,EAAO,IAAI,EAAA,eAAe,CAC9B,yBAGE,EAKE,EAAE,CAEF,EAAO,IAAI,EAAA,aAAa,CAC5B,mBACA,CACE,YAAa,mBACb,cAAe,yBACf,eAAgB,0BAClB,GAEE,EAAY,CAAA,EAEV,EAAQ,KACZ,EAAY,CAAA,EACZ,EAAK,WAAW,GAChB,EAAK,mB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","sources":["<anon>","src/modules/dashboard/taskList.ts"],"sourcesContent":["// modules are defined as an array\n// [ module function, map of requires ]\n//\n// map of requires is short require name -> numeric require\n//\n// anything defined in a previous bundle is accessed via the\n// orig method which is the require for previous bundles\n\n(function (modules, entry, mainEntry, parcelRequireName, globalName) {\n  /* eslint-disable no-undef */\n  var globalObject =\n    typeof globalThis !== 'undefined'\n      ? globalThis\n      : typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n      ? window\n      : typeof global !== 'undefined'\n      ? global\n      : {};\n  /* eslint-enable no-undef */\n\n  // Save the require from previous bundle to this closure if any\n  var previousRequire =\n    typeof globalObject[parcelRequireName] === 'function' &&\n    globalObject[parcelRequireName];\n\n  var cache = previousRequire.cache || {};\n  // Do not use `require` to prevent Webpack from trying to bundle this call\n  var nodeRequire =\n    typeof module !== 'undefined' &&\n    typeof module.require === 'function' &&\n    module.require.bind(module);\n\n  function newRequire(name, jumped) {\n    if (!cache[name]) {\n      if (!modules[name]) {\n        // if we cannot find the module within our internal map or\n        // cache jump to the current global require ie. the last bundle\n        // that was added to the page.\n        var currentRequire =\n          typeof globalObject[parcelRequireName] === 'function' &&\n          globalObject[parcelRequireName];\n        if (!jumped && currentRequire) {\n          return currentRequire(name, true);\n        }\n\n        // If there are other bundles on this page the require from the\n        // previous one is saved to 'previousRequire'. Repeat this as\n        // many times as there are bundles until the module is found or\n        // we exhaust the require chain.\n        if (previousRequire) {\n          return previousRequire(name, true);\n        }\n\n        // Try the node require function if it exists.\n        if (nodeRequire && typeof name === 'string') {\n          return nodeRequire(name);\n        }\n\n        var err = new Error(\"Cannot find module '\" + name + \"'\");\n        err.code = 'MODULE_NOT_FOUND';\n        throw err;\n      }\n\n      localRequire.resolve = resolve;\n      localRequire.cache = {};\n\n      var module = (cache[name] = new newRequire.Module(name));\n\n      modules[name][0].call(\n        module.exports,\n        localRequire,\n        module,\n        module.exports,\n        this\n      );\n    }\n\n    return cache[name].exports;\n\n    function localRequire(x) {\n      var res = localRequire.resolve(x);\n      return res === false ? {} : newRequire(res);\n    }\n\n    function resolve(x) {\n      var id = modules[name][1][x];\n      return id != null ? id : x;\n    }\n  }\n\n  function Module(moduleName) {\n    this.id = moduleName;\n    this.bundle = newRequire;\n    this.exports = {};\n  }\n\n  newRequire.isParcelRequire = true;\n  newRequire.Module = Module;\n  newRequire.modules = modules;\n  newRequire.cache = cache;\n  newRequire.parent = previousRequire;\n  newRequire.register = function (id, exports) {\n    modules[id] = [\n      function (require, module) {\n        module.exports = exports;\n      },\n      {},\n    ];\n  };\n\n  Object.defineProperty(newRequire, 'root', {\n    get: function () {\n      return globalObject[parcelRequireName];\n    },\n  });\n\n  globalObject[parcelRequireName] = newRequire;\n\n  for (var i = 0; i < entry.length; i++) {\n    newRequire(entry[i]);\n  }\n\n  if (mainEntry) {\n    // Expose entry point to Node, AMD or browser globals\n    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js\n    var mainExports = newRequire(mainEntry);\n\n    // CommonJS\n    if (typeof exports === 'object' && typeof module !== 'undefined') {\n      module.exports = mainExports;\n\n      // RequireJS\n    } else if (typeof define === 'function' && define.amd) {\n      define(function () {\n        return mainExports;\n      });\n\n      // <script>\n    } else if (globalName) {\n      this[globalName] = mainExports;\n    }\n  }\n})({\"2nMYY\":[function(require,module,exports) {\nvar parcelHelpers = require(\"@parcel/transformer-js/src/esmodule-helpers.js\");\nparcelHelpers.defineInteropFlag(exports);\nparcelHelpers.export(exports, \"taskList\", ()=>taskList);\nvar _core = require(\"@xatom/core\");\nvar _auth = require(\"../auth\");\nvar _supbase = require(\"../supbase\");\nvar _supbaseDefault = parcelHelpers.interopDefault(_supbase);\nconst renderLogoutBtn = ()=>{\n    const btn = new (0, _core.WFComponent)(`[xa-type=cta-btn]`);\n    btn.on(\"click\", (e)=>{\n        btn.setTextContent(\"Please wait...\");\n        e.preventDefault();\n        (0, _auth.logout)();\n    });\n    btn.setTextContent(\"Logout\");\n};\nconst taskList = ()=>{\n    renderLogoutBtn();\n    const form = new (0, _core.WFFormComponent)(`[xa-type=\"task-list\"]`);\n    let taskList = [];\n    const list = new (0, _core.WFDynamicList)(`[xa-type=\"list\"]`, {\n        rowSelector: `[xa-type=\"item\"]`,\n        emptySelector: `[xa-type=\"list-empty\"]`,\n        loaderSelector: `[xa-type=\"list-loading\"]`\n    });\n    let isLoading = true;\n    const fetch = ()=>{\n        isLoading = true;\n        form.disableForm();\n        list.changeLoadingStatus(true);\n        (0, _supbaseDefault.default).from(\"Task\").select().then((data)=>{\n            console.log(data);\n            form.enableForm();\n            taskList = data.data.sort((a, b)=>a.id - b.id);\n            list.changeLoadingStatus(false);\n            list.setData(taskList);\n            isLoading = false;\n        });\n    };\n    const addTask = (task)=>{\n        isLoading = true;\n        form.disableForm();\n        list.changeLoadingStatus(true);\n        (0, _supbaseDefault.default).from(\"Task\").insert({\n            task: task,\n            done: false,\n            email: (0, _auth.userAuth).getUser().email\n        }).then((data)=>{\n            if (data.error) {\n                form.enableForm();\n                alert(data.error.message || \"Something went wrong!\");\n                isLoading = false;\n                return;\n            }\n            form.resetForm();\n            fetch();\n        });\n    };\n    const changeTaskStatus = (taskId, status)=>{\n        isLoading = true;\n        form.disableForm();\n        list.changeLoadingStatus(true);\n        (0, _supbaseDefault.default).from(\"Task\").update({\n            done: status\n        }).eq(\"id\", taskId).eq(\"email\", (0, _auth.userAuth).getUser().email).then((data)=>{\n            if (data.error) {\n                form.enableForm();\n                alert(data.error.message || \"Something went wrong!\");\n                isLoading = false;\n                return;\n            }\n            form.resetForm();\n            fetch();\n        });\n    };\n    const deleteTask = (taskId)=>{\n        isLoading = true;\n        form.disableForm();\n        list.changeLoadingStatus(true);\n        (0, _supbaseDefault.default).from(\"Task\").delete().eq(\"id\", taskId).eq(\"email\", (0, _auth.userAuth).getUser().email).then((data)=>{\n            if (data.error) {\n                form.enableForm();\n                alert(data.error.message || \"Something went wrong!\");\n                isLoading = false;\n                return;\n            }\n            form.resetForm();\n            fetch();\n        });\n    };\n    list.rowRenderer(({ rowData, rowElement })=>{\n        const { doneBtn, deleteBtn, taskText } = rowElement.getManyChildAsComponents({\n            doneBtn: \"[xa-type=done]\",\n            deleteBtn: \"[xa-type=delete]\",\n            taskText: `[xa-type=item-text]`\n        });\n        rowElement.updateTextViaAttrVar({\n            \"task-text\": rowData.task\n        });\n        if (rowData.done) {\n            doneBtn.addCssClass(\"active\");\n            taskText.addCssClass(\"active\");\n        } else {\n            doneBtn.removeCssClass(\"active\");\n            taskText.removeCssClass(\"active\");\n        }\n        doneBtn.on(\"click\", ()=>{\n            if (isLoading) return;\n            changeTaskStatus(rowData.id, !rowData.done);\n        });\n        deleteBtn.on(\"click\", ()=>{\n            if (isLoading) return;\n            deleteTask(rowData.id);\n        });\n        return rowElement;\n    });\n    list.setData([]);\n    form.onFormSubmit((data)=>{\n        if (!data.task || data.task.trim().length === 0) return;\n        addTask(data.task);\n    });\n    list.emptyRenderer((el)=>{\n        if (isLoading) return null;\n        return el;\n    });\n    fetch();\n};\n\n},{\"@xatom/core\":\"5eqAK\",\"../auth\":\"apxUl\",\"../supbase\":\"54PYi\",\"@parcel/transformer-js/src/esmodule-helpers.js\":\"jiucr\"}]},[], null, \"parcelRequire89a0\")\n\n//# sourceMappingURL=taskList.77c4fca0.js.map\n","import {\n  WFComponent,\n  WFDynamicList,\n  WFFormComponent,\n} from \"@xatom/core\";\nimport { logout, userAuth } from \"../auth\";\nimport supabase from \"../supbase\";\n\nconst renderLogoutBtn = () => {\n  const btn = new WFComponent(`[xa-type=cta-btn]`);\n  btn.on(\"click\", (e) => {\n    btn.setTextContent(\"Please wait...\");\n    e.preventDefault();\n    logout();\n  });\n  btn.setTextContent(\"Logout\");\n};\nexport const taskList = () => {\n  renderLogoutBtn();\n  const form = new WFFormComponent<{ task: string }>(\n    `[xa-type=\"task-list\"]`\n  );\n\n  let taskList: {\n    id: number;\n    task: string;\n    done: boolean;\n    created_at: string;\n  }[] = [];\n\n  const list = new WFDynamicList<(typeof taskList)[0]>(\n    `[xa-type=\"list\"]`,\n    {\n      rowSelector: `[xa-type=\"item\"]`,\n      emptySelector: `[xa-type=\"list-empty\"]`,\n      loaderSelector: `[xa-type=\"list-loading\"]`,\n    }\n  );\n  let isLoading = true;\n\n  const fetch = () => {\n    isLoading = true;\n    form.disableForm();\n    list.changeLoadingStatus(true);\n    supabase\n      .from(\"Task\")\n      .select()\n      .then((data) => {\n        console.log(data);\n        form.enableForm();\n        taskList = data.data.sort((a, b) => a.id - b.id);\n        list.changeLoadingStatus(false);\n        list.setData(taskList);\n        isLoading = false;\n      });\n  };\n\n  const addTask = (task: string) => {\n    isLoading = true;\n    form.disableForm();\n    list.changeLoadingStatus(true);\n    supabase\n      .from(\"Task\")\n      .insert({\n        task: task,\n        done: false,\n        email: userAuth.getUser().email,\n      })\n      .then((data) => {\n        if (data.error) {\n          form.enableForm();\n          alert(\n            data.error.message || \"Something went wrong!\"\n          );\n          isLoading = false;\n\n          return;\n        }\n        form.resetForm();\n        fetch();\n      });\n  };\n  const changeTaskStatus = (\n    taskId: number,\n    status: boolean\n  ) => {\n    isLoading = true;\n    form.disableForm();\n    list.changeLoadingStatus(true);\n    supabase\n      .from(\"Task\")\n      .update({\n        done: status,\n      })\n      .eq(\"id\", taskId)\n      .eq(\"email\", userAuth.getUser().email)\n      .then((data) => {\n        if (data.error) {\n          form.enableForm();\n          alert(\n            data.error.message || \"Something went wrong!\"\n          );\n          isLoading = false;\n          return;\n        }\n        form.resetForm();\n        fetch();\n      });\n  };\n  const deleteTask = (taskId: number) => {\n    isLoading = true;\n    form.disableForm();\n    list.changeLoadingStatus(true);\n    supabase\n      .from(\"Task\")\n      .delete()\n      .eq(\"id\", taskId)\n      .eq(\"email\", userAuth.getUser().email)\n      .then((data) => {\n        if (data.error) {\n          form.enableForm();\n          alert(\n            data.error.message || \"Something went wrong!\"\n          );\n          isLoading = false;\n          return;\n        }\n        form.resetForm();\n        fetch();\n      });\n  };\n\n  list.rowRenderer(({ rowData, rowElement }) => {\n    const { doneBtn, deleteBtn, taskText } =\n      rowElement.getManyChildAsComponents({\n        doneBtn: \"[xa-type=done]\",\n        deleteBtn: \"[xa-type=delete]\",\n        taskText: `[xa-type=item-text]`,\n      });\n    rowElement.updateTextViaAttrVar({\n      \"task-text\": rowData.task,\n    });\n    if (rowData.done) {\n      doneBtn.addCssClass(\"active\");\n      taskText.addCssClass(\"active\");\n    } else {\n      doneBtn.removeCssClass(\"active\");\n      taskText.removeCssClass(\"active\");\n    }\n\n    doneBtn.on(\"click\", () => {\n      if (isLoading) {\n        return;\n      }\n      changeTaskStatus(rowData.id, !rowData.done);\n    });\n    deleteBtn.on(\"click\", () => {\n      if (isLoading) {\n        return;\n      }\n      deleteTask(rowData.id);\n    });\n\n    return rowElement;\n  });\n\n  list.setData([]);\n\n  form.onFormSubmit((data) => {\n    if (!data.task || data.task.trim().length === 0) {\n      return;\n    }\n\n    addTask(data.task);\n  });\n\n  list.emptyRenderer((el) => {\n    if (isLoading) {\n      return null;\n    }\n\n    return el;\n  });\n  fetch();\n};\n"],"names":["modules","entry","mainEntry","parcelRequireName","globalName","globalObject","globalThis","self","window","global","previousRequire","cache","nodeRequire","module","require","bind","newRequire","name","jumped","currentRequire","err","Error","code","localRequire","resolve","x","id","Module","call","exports","res","isParcelRequire","moduleName","bundle","parent","register","Object","defineProperty","get","i","length","parcelHelpers","defineInteropFlag","export","taskList","_core","_auth","_supbase","_supbaseDefault","interopDefault","renderLogoutBtn","btn","WFComponent","on","e","setTextContent","preventDefault","logout","form","WFFormComponent","list","WFDynamicList","rowSelector","emptySelector","loaderSelector","isLoading","fetch","disableForm","changeLoadingStatus","default","from","select","then","data","console","log","enableForm","sort","a","b","setData","addTask","task","insert","done","email","userAuth","getUser","error","alert","message","resetForm","changeTaskStatus","taskId","status","update","eq","deleteTask","delete","rowRenderer","rowData","rowElement","doneBtn","deleteBtn","taskText","getManyChildAsComponents","updateTextViaAttrVar","addCssClass","removeCssClass","onFormSubmit","trim","emptyRenderer","el"],"version":3,"file":"taskList.77c4fca0.js.map"}